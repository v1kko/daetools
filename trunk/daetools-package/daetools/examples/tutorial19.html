<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="Generator" content="Kate, the KDE Advanced Text Editor" />
<title>tutorial19.py</title>
</head>
<!-- Highlighting: "Python" -->
<body>
<pre style='color:#1f1c1b;background-color:#ffffff;'>
<span style='color:#017a31;'>#!/usr/bin/env python</span>
<span style='color:#017a31;'># -*- coding: utf-8 -*-</span>

<span style='color:#017a31;'>&quot;&quot;&quot;</span>
<span style='color:#017a31;'>***********************************************************************************</span>
<span style='color:#017a31;'>                            tutorial19.py</span>
<span style='color:#017a31;'>                DAE Tools: pyDAE module, www.daetools.com</span>
<span style='color:#017a31;'>                Copyright (C) Dragan Nikolic</span>
<span style='color:#017a31;'>***********************************************************************************</span>
<span style='color:#017a31;'>DAE Tools is free software; you can redistribute it and/or modify it under the</span>
<span style='color:#017a31;'>terms of the GNU General Public License version 3 as published by the Free Software</span>
<span style='color:#017a31;'>Foundation. DAE Tools is distributed in the hope that it will be useful, but WITHOUT</span>
<span style='color:#017a31;'>ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A</span>
<span style='color:#017a31;'>PARTICULAR PURPOSE. See the GNU General Public License for more details.</span>
<span style='color:#017a31;'>You should have received a copy of the GNU General Public License along with the</span>
<span style='color:#017a31;'>DAE Tools software; if not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<span style='color:#017a31;'>************************************************************************************</span>
<span style='color:#017a31;'>&quot;&quot;&quot;</span>
__doc__ <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc0000;'>&quot;&quot;&quot;</span>
<span style='color:#cc0000;'>This tutorial introduces the thermo physical property packages.</span>

<span style='color:#cc0000;'>Since there are many thermo packages with a very different API the CapeOpen</span>
<span style='color:#cc0000;'>standard has been adopted in daetools. This way, all thermo packages implementing</span>
<span style='color:#cc0000;'>the CapeOpen thermo interfaces are automatically vailable to daetools. Those which</span>
<span style='color:#cc0000;'>do not are wrapped by the class with the CapeOpen conforming API.</span>
<span style='color:#cc0000;'>At the moment, two types of thermophysical property packages are implemented:</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>- Any CapeOpen v1.1 thermo package (available only in Windows)</span>
<span style='color:#cc0000;'>- CoolProp thermo package (available for all platforms) wrapped in</span>
<span style='color:#cc0000;'>  the class with the CapeOpen interface.</span>
<span style='color:#cc0000;'>  </span>
<span style='color:#cc0000;'>The central point is the daeThermoPhysicalPropertyPackage class. It can load any</span>
<span style='color:#cc0000;'>COM component that implements CapeOpen 1.1 ICapeThermoPropertyPackageManager interface</span>
<span style='color:#cc0000;'>or the CoolProp thermo package.</span>

<span style='color:#cc0000;'>The framework provides low-level functions (specified in the CapeOpen standard) in the</span>
<span style='color:#cc0000;'>daeThermoPhysicalPropertyPackage class and the higher-level functions in the auxiliary</span>
<span style='color:#cc0000;'>daeThermoPackage class defined in the daetools/pyDAE/thermo_packages.py file.</span>
<span style='color:#cc0000;'>The low-level functions are defined in the ICapeThermoCoumpounds and ICapeThermoPropertyRoutine</span>
<span style='color:#cc0000;'>CapeOpen interfaces. These functions come in two flavours:</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>(a) The ordinary functions return adouble/adouble_array objects and can only be used to specify equations:</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>    - GetCompoundConstant (from ICapeThermoCoumpounds interface)</span>
<span style='color:#cc0000;'>    - GetTDependentProperty (from ICapeThermoCoumpounds interface)</span>
<span style='color:#cc0000;'>    - GetPDependentProperty (from ICapeThermoCoumpounds interface)</span>
<span style='color:#cc0000;'>    - CalcSinglePhaseScalarProperty (from ICapeThermoPropertyRoutine interface: scalar version)</span>
<span style='color:#cc0000;'>    - CalcSinglePhaseVectorProperty (from ICapeThermoPropertyRoutine interface: vector version)</span>
<span style='color:#cc0000;'>    - CalcTwoPhaseScalarProperty (from ICapeThermoPropertyRoutine interface: scalar version)</span>
<span style='color:#cc0000;'>    - CalcTwoPhaseVectorProperty (from ICapeThermoPropertyRoutine interface: vector version)</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>(b) The functions starting with the underscores can be used for calculations (they use and return float values):</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>    - _GetCompoundConstant</span>
<span style='color:#cc0000;'>    - _GetTDependentProperty</span>
<span style='color:#cc0000;'>    - _GetPDependentProperty</span>
<span style='color:#cc0000;'>    - _CalcSinglePhaseScalarProperty</span>
<span style='color:#cc0000;'>    - _CalcSinglePhaseVectorProperty</span>
<span style='color:#cc0000;'>    - _CalcTwoPhaseScalarProperty</span>
<span style='color:#cc0000;'>    - _CalcTwoPhaseVectorProperty</span>

<span style='color:#cc0000;'>The daeThermoPackage auxiliary class offers functions to calculate specified properties, for instance:</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>- Transport properties:</span>
<span style='color:#cc0000;'>      </span>
<span style='color:#cc0000;'>  - cp, kappa, mu, Dab (heat capacity, thermal conductivity, dynamic viscosity, diffusion coefficient)</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>- Thermodynamic properties:</span>
<span style='color:#cc0000;'>      </span>
<span style='color:#cc0000;'>  - rho</span>
<span style='color:#cc0000;'>  - h, s, G, H, I (enthalpy, entropy, gibbs/helmholtz/internal energy)</span>
<span style='color:#cc0000;'>  - h_E, s_E, G_E, H_E, I_E, V_E (excess enthalpy, entropy, gibbs/helmholtz/internal energy, volume)</span>
<span style='color:#cc0000;'>  - f and phi (fugacity and coefficient of fugacity)</span>
<span style='color:#cc0000;'>  - a and gamma (activity and the coefficient of activity)</span>
<span style='color:#cc0000;'>  - z (compressibility factor)</span>
<span style='color:#cc0000;'>  - K, surfaceTension (ratio of fugacity coefficients and the surface tension)</span>

<span style='color:#cc0000;'>Nota bene:</span>
<span style='color:#cc0000;'>  Some of the above functions return scalars while the others return arrays of values.</span>
<span style='color:#cc0000;'>  Check the thermo_packages.py file for details.</span>

<span style='color:#cc0000;'>All functions return properties in the SI units (as specified in the CapeOpen 1.1 standard).</span>

<span style='color:#cc0000;'>Known issues:</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>- Many properties from the CapeOpen standard are not supported by all thermo packages.</span>
<span style='color:#cc0000;'>- CalcEquilibrium from the ICapeThermoEquilibriumRoutine is not supported.</span>
<span style='color:#cc0000;'>- CoolProp does not provide transport models for many compounds.</span>
<span style='color:#cc0000;'>- The function calls are NOT thread safe.</span>
<span style='color:#cc0000;'>- The code generation will NOT work for models using the thermo packages.</span>
<span style='color:#cc0000;'>- Some CapeOpen thermo packags refuse to return properties for mass basis (i.e. density).</span>

<span style='color:#cc0000;'>In this tutorial, we use a very simple model: a quantity of liquid (water + ethanol mixture) </span>
<span style='color:#cc0000;'>is heated using the constant input power. The model uses a thermo package to calculate the commonly</span>
<span style='color:#cc0000;'>used transport properties such as specific heat capacity, thermal conductivity, dynamic viscosity</span>
<span style='color:#cc0000;'>and binary diffusion coefficients. First, the low-level functions are tested for CapeOpen and </span>
<span style='color:#cc0000;'>CoolProp packages in the test_single_phase, test_two_phase, test_coolprop_single_phase functions. </span>
<span style='color:#cc0000;'>The results depend on the options selected in the CapeOpen package (equation of state, etc.).</span>
<span style='color:#cc0000;'>Then, the model that uses a thermo package is simulated.</span>

<span style='color:#cc0000;'>The plot of the specific heat capacity as a function of temperature:</span>
<span style='color:#cc0000;'>    </span>
<span style='color:#cc0000;'>.. image:: _static/tutorial19-results.png</span>
<span style='color:#cc0000;'>   :width: 500px</span>
<span style='color:#cc0000;'>   </span>
<span style='color:#cc0000;'>Nota bene:</span>
<span style='color:#cc0000;'>  There is a difference between results in Windows and other platforms since </span>
<span style='color:#cc0000;'>  the CapeOpen thermo packages are available only in Windows.</span>
<span style='color:#cc0000;'>&quot;&quot;&quot;</span>

<span style='color:#3605fb;'>import</span> sys
<span style='color:#3605fb;'>from</span> time <span style='color:#3605fb;'>import</span> localtime, strftime
<span style='color:#3605fb;'>import</span> daetools
<span style='color:#3605fb;'>from</span> daetools.pyDAE <span style='color:#3605fb;'>import</span> <b><span style='color:#0000ff;'>*</span></b>

<span style='color:#017a31;'># Standard variable types are defined in variable_types.py</span>
<span style='color:#3605fb;'>from</span> pyUnits <span style='color:#3605fb;'>import</span> m, g, kg, s, K, Pa, mol, J, W

<b>def</b> test_single_phase():
    <span style='color:#017a31;'>&quot;&quot;&quot;</span>
<span style='color:#017a31;'>    Test the low-level functions offered by the CapeOpen standard (functions starting with underscores):</span>
<span style='color:#017a31;'>      - _GetCompoundConstant</span>
<span style='color:#017a31;'>      - _GetTDependentProperty</span>
<span style='color:#017a31;'>      - _GetPDependentProperty</span>
<span style='color:#017a31;'>      - _CalcSinglePhaseScalarProperty</span>
<span style='color:#017a31;'>      - _CalcSinglePhaseVectorProperty</span>
<span style='color:#017a31;'>    Here we use the ChemSep property package.</span>
<span style='color:#017a31;'>    In general, any package implementing thermo 1.1 standard can be used.</span>
<span style='color:#017a31;'>    The package &quot;H2+CH4+CO2&quot; must be created and configured using the property package manager.</span>
<span style='color:#017a31;'>    It contains three components (H2, CH4 and CO2).</span>
<span style='color:#017a31;'>    </span><span style='color:#017a31;'>&quot;&quot;&quot;</span>
    ctpp <b><span style='color:#0000ff;'>=</span></b> daeThermoPackage(<span style='color:#cc0000;'>&quot;ChemSepCapeOpenTPP&quot;</span>, <span style='color:#3605fb;'>None</span>, <span style='color:#cc0000;'>&quot;&quot;</span>)
    ctpp.LoadCapeOpen(<span style='color:#cc0000;'>&quot;ChemSep Property Package Manager&quot;</span>,  <span style='color:#017a31;'># packageManager name (case sensitive)</span>
                      <span style='color:#cc0000;'>&quot;H2+CH4+CO2&quot;</span>,                        <span style='color:#017a31;'># package name (case sensitive)</span>
                      [<span style='color:#cc0000;'>&quot;Hydrogen&quot;</span>, <span style='color:#cc0000;'>&quot;Methane&quot;</span>,
                       <span style='color:#cc0000;'>&quot;Carbon dioxide&quot;</span>],                  <span style='color:#017a31;'># compound IDs in the mixture</span>
                      [],                                  <span style='color:#017a31;'># compund CAS numbers (optional)</span>
                      {<span style='color:#cc0000;'>&quot;Vapor&quot;</span>:eVapor},                    <span style='color:#017a31;'># dictionary {'phaseLabel' : stateOfAggregation}</span>
                                                           <span style='color:#017a31;'>#   where stateOfAggregation can be:</span>
                                                           <span style='color:#017a31;'>#   eVapor, eLiquid, eSolid or etppPhaseUnknown</span>
                      eMole,                               <span style='color:#017a31;'># optional: default basis (eMole  by default)</span>
                      {})                                  <span style='color:#017a31;'># optional: options dictionary (empty by default)</span>

    P <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>2e5</span>
    T <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>300</span>
    x <b><span style='color:#0000ff;'>=</span></b> [<span style='color:#cc047c;'>0.755</span>, <span style='color:#cc047c;'>0.075</span>, <span style='color:#cc047c;'>0.170</span>]

    <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;*****************************************************************&quot;</span>)
    <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;                 Cape-Open single phase tests                    &quot;</span>)
    <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;*****************************************************************&quot;</span>)

    <span style='color:#017a31;'># Pure compound properties from the ICapeThermoCompounds interface.</span>
    <b>try</b>:
        result <b><span style='color:#0000ff;'>=</span></b> ctpp._GetCompoundConstant(<span style='color:#cc0000;'>&quot;heatOfFusionAtNormalFreezingPoint&quot;</span>, <span style='color:#cc0000;'>&quot;Hydrogen&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 1. heatOfFusionAtNormalFreezingPoint = </span><span style='color:#cc0000;'>%f</span><span style='color:#cc0000;'> J/mol&quot;</span> <b><span style='color:#0000ff;'>%</span></b> result)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 1. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        result <b><span style='color:#0000ff;'>=</span></b> ctpp._GetTDependentProperty(<span style='color:#cc0000;'>&quot;idealGasEnthalpy&quot;</span>, T, <span style='color:#cc0000;'>&quot;Methane&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 2. idealGasEnthalpy = </span><span style='color:#cc0000;'>%f</span><span style='color:#cc0000;'> J/mol&quot;</span> <b><span style='color:#0000ff;'>%</span></b> result)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 2. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        result <b><span style='color:#0000ff;'>=</span></b> ctpp._GetPDependentProperty(<span style='color:#cc0000;'>&quot;boilingPointTemperature&quot;</span>, P, <span style='color:#cc0000;'>&quot;Hydrogen&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 3. boilingPointTemperature = </span><span style='color:#cc0000;'>%f</span><span style='color:#cc0000;'> K&quot;</span> <b><span style='color:#0000ff;'>%</span></b> result)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 3. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <span style='color:#017a31;'># Mixture properties from the ICapeThermoPropertyRoutine interface</span>
    <b>try</b>:
        result <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcSinglePhaseScalarProperty(<span style='color:#cc0000;'>&quot;density&quot;</span>,  P, T, x, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>, eMole)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 4. density = </span><span style='color:#cc0000;'>%f</span><span style='color:#cc0000;'> mol/m^3&quot;</span> <b><span style='color:#0000ff;'>%</span></b> result)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 3. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        results <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcSinglePhaseScalarProperty(<span style='color:#cc0000;'>&quot;heatCapacityCp&quot;</span>,  P, T, x, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>, eMole)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 5. heatCapacityCp = </span><span style='color:#cc0000;'>%s</span><span style='color:#cc0000;'> J/(mol.K)&quot;</span> <b><span style='color:#0000ff;'>%</span></b> results)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 5. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        results <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcSinglePhaseScalarProperty(<span style='color:#cc0000;'>&quot;thermalConductivity&quot;</span>,  P, T, x, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>, eUndefinedBasis)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 6. thermalConductivity = </span><span style='color:#cc0000;'>%s</span><span style='color:#cc0000;'> W/(m.K)&quot;</span> <b><span style='color:#0000ff;'>%</span></b> results)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 6. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        results <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcSinglePhaseScalarProperty(<span style='color:#cc0000;'>&quot;viscosity&quot;</span>,  P, T, x, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>, eUndefinedBasis)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 7. viscosity = </span><span style='color:#cc0000;'>%s</span><span style='color:#cc0000;'> Pa.s&quot;</span> <b><span style='color:#0000ff;'>%</span></b> results)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 7. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        results <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcSinglePhaseVectorProperty(<span style='color:#cc0000;'>&quot;diffusionCoefficient&quot;</span>,  P, T, x, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>, eUndefinedBasis)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 8. diffusionCoefficient = </span><span style='color:#cc0000;'>%s</span><span style='color:#cc0000;'> m^2/s&quot;</span> <b><span style='color:#0000ff;'>%</span></b> results)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 8. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

<b>def</b> test_two_phase():
    <span style='color:#017a31;'>&quot;&quot;&quot;</span>
<span style='color:#017a31;'>    Test the two phase low-level functions.</span>
<span style='color:#017a31;'>      - _CalcTwoPhaseScalarProperty</span>
<span style='color:#017a31;'>      - _CalcTwoPhaseVectorProperty</span>
<span style='color:#017a31;'>    Here we use the ChemSep property package again.</span>
<span style='color:#017a31;'>    The package &quot;Water+Ethanol&quot; must be created and configured using the property package manager.</span>
<span style='color:#017a31;'>    It contains two components (water and ethanol).</span>
<span style='color:#017a31;'>    </span><span style='color:#017a31;'>&quot;&quot;&quot;</span>
    ctpp <b><span style='color:#0000ff;'>=</span></b> daeThermoPackage(<span style='color:#cc0000;'>&quot;ChemSepCapeOpenTPP&quot;</span>, <span style='color:#3605fb;'>None</span>, <span style='color:#cc0000;'>&quot;&quot;</span>)
    ctpp.LoadCapeOpen(<span style='color:#cc0000;'>&quot;ChemSep Property Package Manager&quot;</span>,  <span style='color:#017a31;'># packageManager name (case sensitive)</span>
                      <span style='color:#cc0000;'>&quot;Water+Ethanol&quot;</span>,                     <span style='color:#017a31;'># package name (case sensitive)</span>
                      [<span style='color:#cc0000;'>&quot;Water&quot;</span>, <span style='color:#cc0000;'>&quot;Ethanol&quot;</span>],                <span style='color:#017a31;'># compound IDs in the mixture</span>
                      [],                                  <span style='color:#017a31;'># compund CAS numbers (optional)</span>
                      {<span style='color:#cc0000;'>&quot;Vapor&quot;</span>  : eVapor,
                       <span style='color:#cc0000;'>&quot;Liquid&quot;</span> : eLiquid},                <span style='color:#017a31;'># dictionary {'phaseLabel' : stateOfAggregation}</span>
                      eMole,                               <span style='color:#017a31;'># optional: default basis (eMole by default)</span>
                      {})                                  <span style='color:#017a31;'># optional: options dictionary (empty by default)</span>
    P1 <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>1e5</span>
    T1 <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>300</span>
    x1 <b><span style='color:#0000ff;'>=</span></b> [<span style='color:#cc047c;'>0.60</span>, <span style='color:#cc047c;'>0.40</span>]
    P2 <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>1e5</span>
    T2 <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>300</span>
    x2 <b><span style='color:#0000ff;'>=</span></b> [<span style='color:#cc047c;'>0.60</span>, <span style='color:#cc047c;'>0.40</span>]

    <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;*****************************************************************&quot;</span>)
    <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;                   Cape-Open two phase tests                     &quot;</span>)
    <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;*****************************************************************&quot;</span>)

    <span style='color:#017a31;'># Two-pahase mixture properties from the ICapeThermoPropertyRoutine interface</span>
    <b>try</b>:
        result <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcTwoPhaseScalarProperty(<span style='color:#cc0000;'>&quot;surfaceTension&quot;</span>,
                                                 P1, T1, x1, <span style='color:#cc0000;'>&quot;Liquid&quot;</span>,
                                                 P2, T2, x2, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>,
                                                 eUndefinedBasis)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 1. Water+Ethanol mixture surfaceTension = </span><span style='color:#cc0000;'>%f</span><span style='color:#cc0000;'> N/m&quot;</span> <b><span style='color:#0000ff;'>%</span></b> result)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 1. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        results <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcTwoPhaseVectorProperty(<span style='color:#cc0000;'>&quot;kvalue&quot;</span>,
                                                  P1, T1, x1, <span style='color:#cc0000;'>&quot;Liquid&quot;</span>,
                                                  P2, T2, x2, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>,
                                                  eUndefinedBasis)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 2. Water+Ethanol mixture kvalues = </span><span style='color:#cc0000;'>%s</span><span style='color:#cc0000;'>&quot;</span> <b><span style='color:#0000ff;'>%</span></b> results)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 2. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

<b>def</b> test_coolprop_single_phase():
    <span style='color:#017a31;'>&quot;&quot;&quot;</span>
<span style='color:#017a31;'>    Test the CoolProp library.</span>
<span style='color:#017a31;'>    Default backend is HEOS and the default reference state is DEF.</span>
<span style='color:#017a31;'>    Different backends/ref.states can be specified in the options dictionary.</span>
<span style='color:#017a31;'>    Nota bene:</span>
<span style='color:#017a31;'>      CoolProp does not have transport properties models defined for some compounds (i.e. CarbonMonoxide).</span>
<span style='color:#017a31;'>    </span><span style='color:#017a31;'>&quot;&quot;&quot;</span>
    ctpp <b><span style='color:#0000ff;'>=</span></b> daeThermoPackage(<span style='color:#cc0000;'>&quot;CoolPropTPP&quot;</span>, <span style='color:#3605fb;'>None</span>, <span style='color:#cc0000;'>&quot;&quot;</span>)
    ctpp.LoadCoolProp([<span style='color:#cc0000;'>&quot;Hydrogen&quot;</span>, <span style='color:#cc0000;'>&quot;Methane&quot;</span>,
                       <span style='color:#cc0000;'>&quot;CarbonDioxide&quot;</span>],                <span style='color:#017a31;'># compound IDs in the mixture</span>
                       [],                              <span style='color:#017a31;'># unused (compund CAS numbers)</span>
                       {<span style='color:#cc0000;'>&quot;Vapor&quot;</span>  : eVapor},             <span style='color:#017a31;'># dictionary {'phaseLabel' : stateOfAggregation}</span>
                       eMole,                           <span style='color:#017a31;'># optional: default basis (eMole by default)</span>
                       {<span style='color:#cc0000;'>&quot;backend&quot;</span>        : <span style='color:#cc0000;'>&quot;HEOS&quot;</span>,
                        <span style='color:#cc0000;'>&quot;referenceState&quot;</span> : <span style='color:#cc0000;'>&quot;DEF&quot;</span>,
                        <span style='color:#cc0000;'>&quot;debugLevel&quot;</span>     : <span style='color:#cc0000;'>&quot;0&quot;</span>})        <span style='color:#017a31;'># optional: options dictionary (empty by default)</span>


    P <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>2.0e5</span> <span style='color:#017a31;'># Must be in Pascals</span>
    T <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>300</span>   <span style='color:#017a31;'># Must be in Kelvins</span>
    x <b><span style='color:#0000ff;'>=</span></b> [<span style='color:#cc047c;'>0.755</span>, <span style='color:#cc047c;'>0.075</span>, <span style='color:#cc047c;'>0.170</span>]

    <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;*****************************************************************&quot;</span>)
    <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;                  CoolProp single phase tests                    &quot;</span>)
    <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;*****************************************************************&quot;</span>)

    <span style='color:#017a31;'># CoolProp does not implement functions for pure compound properties from the ICapeThermoCompounds interface.</span>
    <span style='color:#017a31;'># Transport mixture properties from the ICapeThermoPropertyRoutine interface</span>
    <b>try</b>:
        result <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcSinglePhaseScalarProperty(<span style='color:#cc0000;'>&quot;density&quot;</span>,  P, T, x, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>, eMole)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 1. density = </span><span style='color:#cc0000;'>%f</span><span style='color:#cc0000;'> mol/m^3&quot;</span> <b><span style='color:#0000ff;'>%</span></b> result)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 1. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        results <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcSinglePhaseScalarProperty(<span style='color:#cc0000;'>&quot;heatCapacityCp&quot;</span>,  P, T, x, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>, eMole)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 2. heatCapacityCp = </span><span style='color:#cc0000;'>%s</span><span style='color:#cc0000;'> J/(mol.K)&quot;</span> <b><span style='color:#0000ff;'>%</span></b> results)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 2. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        results <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcSinglePhaseScalarProperty(<span style='color:#cc0000;'>&quot;thermalConductivity&quot;</span>,  P, T, x, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>, eUndefinedBasis)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 3. thermalConductivity = </span><span style='color:#cc0000;'>%s</span><span style='color:#cc0000;'> W/(m.K)&quot;</span> <b><span style='color:#0000ff;'>%</span></b> results)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 3. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        results <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcSinglePhaseScalarProperty(<span style='color:#cc0000;'>&quot;viscosity&quot;</span>,  P, T, x, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>, eUndefinedBasis)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 4. viscosity = </span><span style='color:#cc0000;'>%s</span><span style='color:#cc0000;'> Pa.s&quot;</span> <b><span style='color:#0000ff;'>%</span></b> results)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 4. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

    <b>try</b>:
        results <b><span style='color:#0000ff;'>=</span></b> ctpp._CalcSinglePhaseVectorProperty(<span style='color:#cc0000;'>&quot;diffusionCoefficient&quot;</span>,  P, T, x, <span style='color:#cc0000;'>&quot;Vapor&quot;</span>, eUndefinedBasis)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 5. diffusionCoefficient = </span><span style='color:#cc0000;'>%s</span><span style='color:#cc0000;'> m^2/s&quot;</span> <b><span style='color:#0000ff;'>%</span></b> results)
    <b>except</b> <b><span style='color:#4e9a06;'>Exception</span></b> <span style='color:#3605fb;'>as</span> e:
        <span style='color:#2a00d6;'>print</span>(<span style='color:#cc0000;'>&quot;Test 5. Calculation failed&quot;</span>)
        <span style='color:#2a00d6;'>print</span>(<span style='color:#2a00d6;'>str</span>(e))

<b>class</b> modTutorial(daeModel):
    <b>def</b> <b><span style='color:#000e52;'>__init__</span></b>(<span style='color:#3605fb;'>self</span>, Name, Parent <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>None</span>, Description <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc0000;'>&quot;&quot;</span>):
        daeModel.<b><span style='color:#000e52;'>__init__</span></b>(<span style='color:#3605fb;'>self</span>, Name, Parent, Description)

        <span style='color:#3605fb;'>self</span>.tpp <b><span style='color:#0000ff;'>=</span></b> daeThermoPackage(<span style='color:#cc0000;'>&quot;TPP&quot;</span>, <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;&quot;</span>)
        <span style='color:#017a31;'># CapeOpen thermo packages are available only in Windows.</span>
        <span style='color:#017a31;'># For other platforms use CoolProp thermo package.</span>
        <b>if</b> daetools.daetools_system <b><span style='color:#0000ff;'>==</span></b> <span style='color:#cc0000;'>'Windows'</span>:
            <span style='color:#3605fb;'>self</span>.tpp.LoadCapeOpen(<span style='color:#cc0000;'>&quot;ChemSep Property Package Manager&quot;</span>, <span style='color:#017a31;'># packageManager name (case sensitive)</span>
                                  <span style='color:#cc0000;'>&quot;Water+Ethanol&quot;</span>,                    <span style='color:#017a31;'># package name (case sensitive)</span>
                                  [<span style='color:#cc0000;'>&quot;Water&quot;</span>, <span style='color:#cc0000;'>&quot;Ethanol&quot;</span>],               <span style='color:#017a31;'># compound IDs in the mixture</span>
                                  [],                                 <span style='color:#017a31;'># compund CAS numbers (optional)</span>
                                  {<span style='color:#cc0000;'>'Liquid'</span>:eLiquid},                 <span style='color:#017a31;'># dictionary {'phaseLabel' : stateOfAggregation}</span>
                                  eMole,                              <span style='color:#017a31;'># default basis is eMole (other options are eMass or eUndefinedBasis)</span>
                                  {})                                 <span style='color:#017a31;'># options dictionary (defaut is empty)</span>
        <b>else</b>:
            <span style='color:#3605fb;'>self</span>.tpp.LoadCoolProp([<span style='color:#cc0000;'>&quot;Water&quot;</span>, <span style='color:#cc0000;'>&quot;Ethanol&quot;</span>],               <span style='color:#017a31;'># compound IDs in the mixture</span>
                                  [],                                 <span style='color:#017a31;'># compund CAS numbers (optional)</span>
                                  {<span style='color:#cc0000;'>'Liquid'</span>:eLiquid},                 <span style='color:#017a31;'># dictionary {'phaseLabel' : stateOfAggregation}</span>
                                  eMole,                              <span style='color:#017a31;'># default basis is eMole (other options are eMass or eUndefinedBasis)</span>
                                  {})                                 <span style='color:#017a31;'># options dictionary (defaut is empty)</span>

        <span style='color:#3605fb;'>self</span>.m    <b><span style='color:#0000ff;'>=</span></b> daeParameter(<span style='color:#cc0000;'>&quot;m&quot;</span>, kg, <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;Mass of water&quot;</span>)

        <span style='color:#3605fb;'>self</span>.cp    <b><span style='color:#0000ff;'>=</span></b> daeVariable(<span style='color:#cc0000;'>&quot;c_p&quot;</span>,   specific_heat_capacity_t, <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;Specific heat capacity of the liquid&quot;</span>)
        <span style='color:#3605fb;'>self</span>.kappa <b><span style='color:#0000ff;'>=</span></b> daeVariable(<span style='color:#cc0000;'>&quot;k&quot;</span>,     thermal_conductivity_t,   <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;Thermal conductivity of the liquid&quot;</span>)
        <span style='color:#3605fb;'>self</span>.mu    <b><span style='color:#0000ff;'>=</span></b> daeVariable(<span style='color:#cc0000;'>&quot;mu&quot;</span>,    dynamic_viscosity_t,      <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;Viscosity of the liquid&quot;</span>)
        <span style='color:#3605fb;'>self</span>.Qin   <b><span style='color:#0000ff;'>=</span></b> daeVariable(<span style='color:#cc0000;'>&quot;Q_in&quot;</span>,  power_t,                  <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;Power of the heater&quot;</span>)
        <span style='color:#3605fb;'>self</span>.T     <b><span style='color:#0000ff;'>=</span></b> daeVariable(<span style='color:#cc0000;'>&quot;T&quot;</span>,     temperature_t,            <span style='color:#3605fb;'>self</span>, <span style='color:#cc0000;'>&quot;Temperature of the liquid&quot;</span>)

    <b>def</b> DeclareEquations(<span style='color:#3605fb;'>self</span>):
        daeModel.DeclareEquations(<span style='color:#3605fb;'>self</span>)

        <span style='color:#017a31;'># P, T, x arguments can be floats or adouble objects/arrays as illustrated here.</span>
        P <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>1e5</span> <b><span style='color:#0000ff;'>*</span></b> Pa
        T <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.T()
        x <b><span style='color:#0000ff;'>=</span></b> [<span style='color:#cc047c;'>0.60</span>, <span style='color:#cc047c;'>0.40</span>]

        <span style='color:#017a31;'># daeThermoPackage uses the default basis to calculate the properties.</span>
        <span style='color:#017a31;'># If a property for a different basis is required it should be specified as a keyword argument 'basis'=eMole|eMass|eUndefinedBasis.</span>
        <span style='color:#017a31;'># Also, it needs the phase information. If there is only one phase it will be used as a default.</span>
        <span style='color:#017a31;'># Otherwise, it must be specified as a keyword argument 'phase'='phaseLabel'.</span>
        <span style='color:#017a31;'># For instance:</span>
        <span style='color:#017a31;'>#    self.tpp.kappa(P,T,x, phase='Vapor', basis=eUndefinedBasis)</span>

        <span style='color:#017a31;'># Calculate transport properties:</span>
        <span style='color:#017a31;'># 1. Specific heat capacity (cp) in J/(kg*K)</span>
        <span style='color:#017a31;'>#    TPP package returns cp in J/(mol.K) (mole basis) - for some reasons it refuses to calculate it for the mass basis.</span>
        <span style='color:#017a31;'>#    Therefore, divide it by the molar mass of the mixture.</span>
        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;C_p&quot;</span>, <span style='color:#cc0000;'>&quot;Specific heat capacity as a function of the temperature.&quot;</span>)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.cp() <b><span style='color:#0000ff;'>-</span></b> <span style='color:#3605fb;'>self</span>.tpp.cp(P,T,x) <b><span style='color:#0000ff;'>/</span></b> <span style='color:#3605fb;'>self</span>.tpp.M(P,T,x)

        <span style='color:#017a31;'># 2. Thermal conductivity (kappa) in W/(m*K)</span>
        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;kappa&quot;</span>, <span style='color:#cc0000;'>&quot;Thermal conductivity as a function of the temperature.&quot;</span>)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.kappa() <b><span style='color:#0000ff;'>-</span></b> <span style='color:#3605fb;'>self</span>.tpp.kappa(P,T,x)

        <span style='color:#017a31;'># 3. Dynamic viscosity (mu) in Pa*s</span>
        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;mu&quot;</span>, <span style='color:#cc0000;'>&quot;Viscosity as a function of the temperature.&quot;</span>)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.mu() <b><span style='color:#0000ff;'>-</span></b> <span style='color:#3605fb;'>self</span>.tpp.mu(P,T,x)

        <span style='color:#017a31;'># Simple integral heat balance for the liquid</span>
        eq <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.CreateEquation(<span style='color:#cc0000;'>&quot;HeatBalance&quot;</span>, <span style='color:#cc0000;'>&quot;Integral heat balance equation&quot;</span>)
        eq.Residual <b><span style='color:#0000ff;'>=</span></b> <span style='color:#3605fb;'>self</span>.m() <b><span style='color:#0000ff;'>*</span></b> <span style='color:#3605fb;'>self</span>.cp() <b><span style='color:#0000ff;'>*</span></b> dt(<span style='color:#3605fb;'>self</span>.T()) <b><span style='color:#0000ff;'>-</span></b> <span style='color:#3605fb;'>self</span>.Qin()

<b>class</b> simTutorial(daeSimulation):
    <b>def</b> <b><span style='color:#000e52;'>__init__</span></b>(<span style='color:#3605fb;'>self</span>):
        daeSimulation.<b><span style='color:#000e52;'>__init__</span></b>(<span style='color:#3605fb;'>self</span>)
        <span style='color:#3605fb;'>self</span>.m <b><span style='color:#0000ff;'>=</span></b> modTutorial(<span style='color:#cc0000;'>&quot;tutorial19&quot;</span>)
        <span style='color:#3605fb;'>self</span>.m.Description <b><span style='color:#0000ff;'>=</span></b> __doc__

    <b>def</b> SetUpParametersAndDomains(<span style='color:#3605fb;'>self</span>):
        <span style='color:#3605fb;'>self</span>.m.m.SetValue(<span style='color:#cc047c;'>1</span> <b><span style='color:#0000ff;'>*</span></b> kg)

    <b>def</b> SetUpVariables(<span style='color:#3605fb;'>self</span>):
        <span style='color:#3605fb;'>self</span>.m.Qin.AssignValue(<span style='color:#cc047c;'>500</span> <b><span style='color:#0000ff;'>*</span></b> W)
        <span style='color:#3605fb;'>self</span>.m.T.SetInitialCondition(<span style='color:#cc047c;'>283</span> <b><span style='color:#0000ff;'>*</span></b> K)

<span style='color:#017a31;'># Use daeSimulator class</span>
<b>def</b> guiRun(app):
    sim <b><span style='color:#0000ff;'>=</span></b> simTutorial()
    sim.m.SetReportingOn(<span style='color:#3605fb;'>True</span>)
    sim.ReportingInterval <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>10</span>
    sim.TimeHorizon       <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>500</span>
    simulator  <b><span style='color:#0000ff;'>=</span></b> daeSimulator(app, simulation<b><span style='color:#0000ff;'>=</span></b>sim)
    simulator.exec_()

<span style='color:#017a31;'># Setup everything manually and run in a console</span>
<b>def</b> consoleRun():
    <span style='color:#017a31;'># Test low-level calculation routines.</span>
    <span style='color:#017a31;'># CapeOpen thermo packages are available only on Windows.</span>
    <b>if</b> daetools.daetools_system <b><span style='color:#0000ff;'>==</span></b> <span style='color:#cc0000;'>'Windows'</span>:
        test_single_phase()
        test_two_phase()
    test_coolprop_single_phase()

    <span style='color:#017a31;'># Create Log, Solver, DataReporter and Simulation object</span>
    log          <b><span style='color:#0000ff;'>=</span></b> daePythonStdOutLog()
    daesolver    <b><span style='color:#0000ff;'>=</span></b> daeIDAS()
    datareporter <b><span style='color:#0000ff;'>=</span></b> daeTCPIPDataReporter()
    simulation   <b><span style='color:#0000ff;'>=</span></b> simTutorial()

    <span style='color:#017a31;'># Enable reporting of all variables</span>
    simulation.m.SetReportingOn(<span style='color:#3605fb;'>True</span>)

    <span style='color:#017a31;'># Set the time horizon and the reporting interval</span>
    simulation.ReportingInterval <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>10</span>
    simulation.TimeHorizon <b><span style='color:#0000ff;'>=</span></b> <span style='color:#cc047c;'>500</span>

    <span style='color:#017a31;'># Connect data reporter</span>
    simName <b><span style='color:#0000ff;'>=</span></b> simulation.m.Name <b><span style='color:#0000ff;'>+</span></b> strftime(<span style='color:#cc0000;'>&quot; [</span><span style='color:#cc0000;'>%d</span><span style='color:#cc0000;'>.%m.%Y %H:%M:%S]&quot;</span>, localtime())
    <b>if</b>(datareporter.Connect(<span style='color:#cc0000;'>&quot;&quot;</span>, simName) <b><span style='color:#0000ff;'>==</span></b> <span style='color:#3605fb;'>False</span>):
        sys.exit()

    <span style='color:#017a31;'># Initialize the simulation</span>
    simulation.Initialize(daesolver, datareporter, log)

    <span style='color:#017a31;'># Save the model report and the runtime model report</span>
    simulation.m.SaveModelReport(simulation.m.Name <b><span style='color:#0000ff;'>+</span></b> <span style='color:#cc0000;'>&quot;.xml&quot;</span>)
    simulation.m.SaveRuntimeModelReport(simulation.m.Name <b><span style='color:#0000ff;'>+</span></b> <span style='color:#cc0000;'>&quot;-rt.xml&quot;</span>)

    <span style='color:#017a31;'># Solve at time=0 (initialization)</span>
    simulation.SolveInitial()

    <span style='color:#017a31;'># Run</span>
    simulation.Run()
    simulation.Finalize()

<b>if</b> <span style='color:#3605fb;'>__name__</span> <b><span style='color:#0000ff;'>==</span></b> <span style='color:#cc0000;'>&quot;__main__&quot;</span>:
    <b>if</b> <span style='color:#2a00d6;'>len</span>(sys.argv) <b><span style='color:#0000ff;'>&gt;</span></b> <span style='color:#cc047c;'>1</span> <b>and</b> (sys.argv[<span style='color:#cc047c;'>1</span>] <b><span style='color:#0000ff;'>==</span></b> <span style='color:#cc0000;'>'console'</span>):
        consoleRun()
    <b>else</b>:
        app <b><span style='color:#0000ff;'>=</span></b> daeCreateQtApplication(sys.argv)
        guiRun(app)
</pre>
</body>
</html>
